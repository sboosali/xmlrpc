<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-2"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-3"></a><span>
</span><a name="line-4"></a><span class="hs-comment">{-|



-}</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Network.XmlRpc.Types</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-11"></a><span>
</span><a name="line-12"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-13"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-14"></a><span>
</span><a name="line-15"></a><span class="hs-comment">--import           &quot;time&quot; Data.Time.Calendar</span><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-string">&quot;time&quot;</span><span> </span><span class="hs-identifier">Data.Time.LocalTime</span><span>
</span><a name="line-17"></a><span>
</span><a name="line-18"></a><span class="hs-comment">-------------------------------------------------</span><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-string">&quot;bytestring&quot;</span><span> </span><span class="hs-identifier">Data.ByteString.Char8</span><span>      </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">BS</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ByteString</span><span class="hs-special">)</span><span>
</span><a name="line-21"></a><span class="hs-comment">--import qualified &quot;bytestring&quot; Data.ByteString.Lazy.Char8 as BL (ByteString)</span><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span class="hs-comment">-------------------------------------------------</span><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span> </span><a href="Prelude_xmlrpc.html"><span class="hs-identifier">Prelude_xmlrpc</span></a><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-28"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span class="hs-comment">{-| An XML-RPC value (similar to @JSON@).

primitive types:

* numbers (int, double)
* strings (strings, bytestrings)
* booleans
* timestamps

composite types:

* array (a list of Values)
* struct (a map from Strings to Values)

NOTE:

* 'ValueBase64': provide the raw data via a smart-constructor (like 'base64Value') which automatically encodes it into the @base-64@ format.

-}</span><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span class="hs-keyword">data</span><span> </span><a name="Value"><a href="Network.XmlRpc.Types.html#Value"><span class="hs-identifier">Value</span></a></a><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="ValueBool"><a href="Network.XmlRpc.Types.html#ValueBool"><span class="hs-identifier">ValueBool</span></a></a><span>        </span><span class="hs-identifier hs-type">Bool</span><span>             </span><span class="hs-comment">-- ^ @&#8801; \&lt;bool\&gt;@</span><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ValueInt"><a href="Network.XmlRpc.Types.html#ValueInt"><span class="hs-identifier">ValueInt</span></a></a><span>         </span><span class="hs-identifier hs-type">Int</span><span>              </span><span class="hs-comment">-- ^ @&#8801; \&lt;int\&gt;@ (or @\&lt;i4\&gt;@ or @\&lt;i8\&gt;@)</span><span>
</span><a name="line-57"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ValueDouble"><a href="Network.XmlRpc.Types.html#ValueDouble"><span class="hs-identifier">ValueDouble</span></a></a><span>      </span><span class="hs-identifier hs-type">Double</span><span>           </span><span class="hs-comment">-- ^ @&#8801; \&lt;double\&gt;@</span><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ValueString"><a href="Network.XmlRpc.Types.html#ValueString"><span class="hs-identifier">ValueString</span></a></a><span>      </span><span class="hs-identifier hs-type">String</span><span>           </span><span class="hs-comment">-- ^ @&#8801; \&lt;string\&gt;@</span><span>
</span><a name="line-60"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ValueUnwrapped"><a href="Network.XmlRpc.Types.html#ValueUnwrapped"><span class="hs-identifier">ValueUnwrapped</span></a></a><span>   </span><span class="hs-identifier hs-type">String</span><span>           </span><span class="hs-comment">-- ^ TODO? (like @\&lt;string\&gt;@, but no inner element)</span><span>
</span><a name="line-61"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ValueBase64"><a href="Network.XmlRpc.Types.html#ValueBase64"><span class="hs-identifier">ValueBase64</span></a></a><span>      </span><span class="hs-identifier hs-type">BS.ByteString</span><span>    </span><span class="hs-comment">-- ^ @&#8801; \&lt;base64\&gt;@</span><span>
</span><a name="line-62"></a><span>
</span><a name="line-63"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ValueDateTime"><a href="Network.XmlRpc.Types.html#ValueDateTime"><span class="hs-identifier">ValueDateTime</span></a></a><span>    </span><span class="hs-identifier hs-type">LocalTime</span><span>        </span><span class="hs-comment">-- ^ @&#8801; \&lt;dateTime.iso8601\&gt;@</span><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ValueStruct"><a href="Network.XmlRpc.Types.html#ValueStruct"><span class="hs-identifier">ValueStruct</span></a></a><span>      </span><a href="Network.XmlRpc.Types.html#StructOfValues"><span class="hs-identifier hs-type">StructOfValues</span></a><span>   </span><span class="hs-comment">-- ^ @&#8801; \&lt;struct\&gt;@</span><span>
</span><a name="line-66"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ValueArray"><a href="Network.XmlRpc.Types.html#ValueArray"><span class="hs-identifier">ValueArray</span></a></a><span>       </span><a href="Network.XmlRpc.Types.html#ArrayOfValues"><span class="hs-identifier hs-type">ArrayOfValues</span></a><span>    </span><span class="hs-comment">-- ^ @&#8801; \&lt;array\&gt;@</span><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">stock</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-69"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">anyclass</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">NFData</span><span class="hs-special">)</span><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span class="hs-comment">{-

[Problem]

    * No instance for (Lift BS.ByteString)
    * No instance for (Hashable LocalTime)

-}</span><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span class="hs-comment">{-|

-}</span><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-keyword">type</span><span> </span><a name="StructOfValues"><a href="Network.XmlRpc.Types.html#StructOfValues"><span class="hs-identifier">StructOfValues</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><a href="Network.XmlRpc.Types.html#Value"><span class="hs-identifier hs-type">Value</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- TODO Map String Value (keys are unordered and unduplicated)</span><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span class="hs-comment">{-|

-}</span><span>
</span><a name="line-93"></a><span>
</span><a name="line-94"></a><span class="hs-keyword">type</span><span> </span><a name="ArrayOfValues"><a href="Network.XmlRpc.Types.html#ArrayOfValues"><span class="hs-identifier">ArrayOfValues</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Network.XmlRpc.Types.html#Value"><span class="hs-identifier hs-type">Value</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- TODO Array/Seq Value (is finite)</span><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span class="hs-comment">{-| An XML-RPC value-type.

Used for error messages and introspection.

-}</span><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span class="hs-keyword">data</span><span> </span><a name="ValueType"><a href="Network.XmlRpc.Types.html#ValueType"><span class="hs-identifier">ValueType</span></a></a><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="TypeBool"><a href="Network.XmlRpc.Types.html#TypeBool"><span class="hs-identifier">TypeBool</span></a></a><span>
</span><a name="line-107"></a><span>
</span><a name="line-108"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TypeInt"><a href="Network.XmlRpc.Types.html#TypeInt"><span class="hs-identifier">TypeInt</span></a></a><span>
</span><a name="line-109"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TypeDouble"><a href="Network.XmlRpc.Types.html#TypeDouble"><span class="hs-identifier">TypeDouble</span></a></a><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TypeString"><a href="Network.XmlRpc.Types.html#TypeString"><span class="hs-identifier">TypeString</span></a></a><span>
</span><a name="line-112"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TypeBase64"><a href="Network.XmlRpc.Types.html#TypeBase64"><span class="hs-identifier">TypeBase64</span></a></a><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TypeDateTime"><a href="Network.XmlRpc.Types.html#TypeDateTime"><span class="hs-identifier">TypeDateTime</span></a></a><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TypeStruct"><a href="Network.XmlRpc.Types.html#TypeStruct"><span class="hs-identifier">TypeStruct</span></a></a><span>
</span><a name="line-117"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TypeArray"><a href="Network.XmlRpc.Types.html#TypeArray"><span class="hs-identifier">TypeArray</span></a></a><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><span>  </span><span class="hs-comment">--TODO | TypeUnknown</span><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">stock</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Bounded</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ix</span><span class="hs-special">)</span><span>
</span><a name="line-122"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">stock</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Lift</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-123"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">anyclass</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">NFData</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Hashable</span><span class="hs-special">)</span><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-126"></a><span>
</span><a name="line-127"></a><span class="hs-comment">{-| An XML-RPC method call.

Consists of a method name ('MethodName') and a list of parameters (@['Value']@).

Corresponds to the @&lt;methodCall&gt;@ element in an XML-RPC request.

-}</span><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span class="hs-keyword">data</span><span> </span><a name="MethodCall"><a href="Network.XmlRpc.Types.html#MethodCall"><span class="hs-identifier">MethodCall</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="MethodCall"><a href="Network.XmlRpc.Types.html#MethodCall"><span class="hs-identifier">MethodCall</span></a></a><span>
</span><a name="line-136"></a><span>
</span><a name="line-137"></a><span> </span><span class="hs-special">{</span><span> </span><a name="function"><a href="Network.XmlRpc.Types.html#function"><span class="hs-identifier">function</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-138"></a><span> </span><span class="hs-special">,</span><span> </span><a name="arguments"><a href="Network.XmlRpc.Types.html#arguments"><span class="hs-identifier">arguments</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Network.XmlRpc.Types.html#Value"><span class="hs-identifier hs-type">Value</span></a><span class="hs-special">]</span><span>
</span><a name="line-139"></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-140"></a><span>
</span><a name="line-141"></a><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">stock</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-142"></a><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">anyclass</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">NFData</span><span class="hs-special">)</span><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-145"></a><span>
</span><a name="line-146"></a><span class="hs-comment">{-| An XML-RPC response.

'MethodFault' is failure, 'MethodReturn' is success.

-}</span><span>
</span><a name="line-151"></a><span>
</span><a name="line-152"></a><span class="hs-keyword">type</span><span> </span><a name="MethodResponse"><a href="Network.XmlRpc.Types.html#MethodResponse"><span class="hs-identifier">MethodResponse</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="Network.XmlRpc.Types.html#MethodFault"><span class="hs-identifier hs-type">MethodFault</span></a><span> </span><a href="Network.XmlRpc.Types.html#MethodReturn"><span class="hs-identifier hs-type">MethodReturn</span></a><span>
</span><a name="line-153"></a><span>
</span><a name="line-154"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-155"></a><span>
</span><a name="line-156"></a><span class="hs-comment">{-|  A successful XML-RPC response.

i.e. the XML-RPC method returns with a single 'Value'.

-}</span><span>
</span><a name="line-161"></a><span>
</span><a name="line-162"></a><span class="hs-keyword">newtype</span><span> </span><a name="MethodReturn"><a href="Network.XmlRpc.Types.html#MethodReturn"><span class="hs-identifier">MethodReturn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="MethodReturn"><a href="Network.XmlRpc.Types.html#MethodReturn"><span class="hs-identifier">MethodReturn</span></a></a><span>
</span><a name="line-163"></a><span>  </span><span class="hs-special">{</span><span> </span><a name="returnValue"><a href="Network.XmlRpc.Types.html#returnValue"><span class="hs-identifier">returnValue</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Network.XmlRpc.Types.html#Value"><span class="hs-identifier hs-type">Value</span></a><span>
</span><a name="line-164"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-165"></a><span>
</span><a name="line-166"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">stock</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-167"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">newtype</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-168"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">newtype</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">NFData</span><span class="hs-special">)</span><span>
</span><a name="line-169"></a><span>
</span><a name="line-170"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-171"></a><span>
</span><a name="line-172"></a><span class="hs-comment">-- | @= 'defaultMethodReturn'@</span><span>
</span><a name="line-173"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Default</span><span> </span><a href="Network.XmlRpc.Types.html#MethodReturn"><span class="hs-identifier hs-type">MethodReturn</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-174"></a><span>  </span><a name="local-8214565720323796668"><span class="hs-identifier">def</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Network.XmlRpc.Types.html#defaultMethodReturn"><span class="hs-identifier hs-var">defaultMethodReturn</span></a><span>
</span><a name="line-175"></a><span>
</span><a name="line-176"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-177"></a><span>
</span><a name="line-178"></a><span class="hs-comment">{-| A failed XML-RPC response. 

i.e. the XML-RPC method fails, with an arbitrary error 'message', and a custom error 'code'.

'MethodFault' corresponds to the @&lt;fault&gt;@ element in an XML-RPC response:

* 'code': corresponds to a @&lt;faultCode&gt;@ element.
* 'messsage': corresponds to @&lt;faultString&gt;@ element.

NOTE the XML-RPC Specification doesn't specify any meanings for error 'code's.
Thus, they can be implementation-defined (e.g. mirroring the @sh@ell exit codes); or service-defined, for a particular server-client pair .

-}</span><span>
</span><a name="line-191"></a><span>
</span><a name="line-192"></a><span class="hs-keyword">data</span><span> </span><a name="MethodFault"><a href="Network.XmlRpc.Types.html#MethodFault"><span class="hs-identifier">MethodFault</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="MethodFault"><a href="Network.XmlRpc.Types.html#MethodFault"><span class="hs-identifier">MethodFault</span></a></a><span>
</span><a name="line-193"></a><span>
</span><a name="line-194"></a><span>  </span><span class="hs-special">{</span><span> </span><a name="code"><a href="Network.XmlRpc.Types.html#code"><span class="hs-identifier">code</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-195"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="message"><a href="Network.XmlRpc.Types.html#message"><span class="hs-identifier">message</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-196"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-197"></a><span>
</span><a name="line-198"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">stock</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Lift</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-199"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">anyclass</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">NFData</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Hashable</span><span class="hs-special">)</span><span>
</span><a name="line-200"></a><span>
</span><a name="line-201"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-202"></a><span>
</span><a name="line-203"></a><span class="hs-comment">-- | @= 'defaultMethodFault'@</span><span>
</span><a name="line-204"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Default</span><span> </span><a href="Network.XmlRpc.Types.html#MethodFault"><span class="hs-identifier hs-type">MethodFault</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-205"></a><span>  </span><a name="local-8214565720323796668"><span class="hs-identifier">def</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Network.XmlRpc.Types.html#defaultMethodFault"><span class="hs-identifier hs-var">defaultMethodFault</span></a><span>
</span><a name="line-206"></a><span>
</span><a name="line-207"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-208"></a><span>
</span><a name="line-209"></a><span class="hs-comment">{- |

The @&lt;methodName&gt;@ string in an XML-RPC request can have only the following characters:

* alphanumeric (i.e. upper-case @A-Z@, lower-case @a-z@, and numeric characters @0-9@)
* identifier
* underscore, dot, colon, slash

-}</span><span>
</span><a name="line-218"></a><span>
</span><a name="line-219"></a><span class="hs-keyword">newtype</span><span> </span><a name="MethodName"><a href="Network.XmlRpc.Types.html#MethodName"><span class="hs-identifier">MethodName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="MethodName"><a href="Network.XmlRpc.Types.html#MethodName"><span class="hs-identifier">MethodName</span></a></a><span>
</span><a name="line-220"></a><span>
</span><a name="line-221"></a><span>  </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-222"></a><span>
</span><a name="line-223"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">stock</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Lift</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-224"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">newtype</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Semigroup</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Monoid</span><span class="hs-special">)</span><span>
</span><a name="line-225"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">newtype</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">NFData</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Hashable</span><span class="hs-special">)</span><span>
</span><a name="line-226"></a><span>
</span><a name="line-227"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">IsString</span><span> </span><a href="Network.XmlRpc.Types.html#MethodName"><span class="hs-identifier hs-type">MethodName</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-228"></a><span>  </span><a name="local-3458764513820541114"><span class="hs-identifier">fromString</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">coerce</span><span>
</span><a name="line-229"></a><span>
</span><a name="line-230"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-231"></a><span>
</span><a name="line-232"></a><span class="hs-comment">{-| 

@&#8781; ExceptT String m a@

-}</span><span>
</span><a name="line-237"></a><span>
</span><a name="line-238"></a><span class="hs-keyword">data</span><span> </span><a name="Parser"><a href="Network.XmlRpc.Types.html#Parser"><span class="hs-identifier">Parser</span></a></a><span> </span><a name="local-6989586621679135830"><a href="#local-6989586621679135830"><span class="hs-identifier">a</span></a></a><span>
</span><a name="line-239"></a><span>
</span><a name="line-240"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="Parser"><a href="Network.XmlRpc.Types.html#Parser"><span class="hs-identifier">Parser</span></a></a><span> </span><a href="#local-6989586621679135830"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-241"></a><span>
</span><a name="line-242"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">stock</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Functor</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Foldable</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Traversable</span><span class="hs-special">)</span><span>
</span><a name="line-243"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">stock</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Lift</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-244"></a><span> </span><span class="hs-comment">-- deriving anyclass (NFData,Hashable)</span><span>
</span><a name="line-245"></a><span>
</span><a name="line-246"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Applicative</span><span> </span><a href="Network.XmlRpc.Types.html#Parser"><span class="hs-identifier hs-type">Parser</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-247"></a><span>  </span><a name="local-3458764513820541680"><span class="hs-identifier">pure</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Network.XmlRpc.Types.html#Parser"><span class="hs-identifier hs-var">Parser</span></a><span>
</span><a name="line-248"></a><span>  </span><span class="hs-special">(</span><a href="Network.XmlRpc.Types.html#Parser"><span class="hs-identifier hs-var">Parser</span></a><span> </span><a name="local-6989586621679135831"><a href="#local-6989586621679135831"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><a name="local-3458764513820541679"><span class="hs-operator">&lt;*&gt;</span></a><span> </span><span class="hs-special">(</span><a href="Network.XmlRpc.Types.html#Parser"><span class="hs-identifier hs-var">Parser</span></a><span> </span><a name="local-6989586621679135832"><a href="#local-6989586621679135832"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Network.XmlRpc.Types.html#Parser"><span class="hs-identifier hs-var">Parser</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679135831"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679135832"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-249"></a><span>
</span><a name="line-250"></a><span class="hs-comment">-- instance Monad     Parser</span><span>
</span><a name="line-251"></a><span class="hs-comment">-- instance MonadFail Parser</span><span>
</span><a name="line-252"></a><span>
</span><a name="line-253"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-254"></a><span>
</span><a name="line-255"></a><span class="hs-comment">{-| 

@~ Either String a@

-}</span><span>
</span><a name="line-260"></a><span>
</span><a name="line-261"></a><span class="hs-keyword">data</span><span> </span><a name="Result"><a href="Network.XmlRpc.Types.html#Result"><span class="hs-identifier">Result</span></a></a><span> </span><a name="local-6989586621679135829"><a href="#local-6989586621679135829"><span class="hs-identifier">a</span></a></a><span>
</span><a name="line-262"></a><span>
</span><a name="line-263"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-264"></a><span>
</span><a name="line-265"></a><span class="hs-comment">{-| @= 'stringValue'@

**WARNING** this is a partial function.

-}</span><span>
</span><a name="line-270"></a><span>
</span><a name="line-271"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">IsString</span><span> </span><a href="Network.XmlRpc.Types.html#Value"><span class="hs-identifier hs-type">Value</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-272"></a><span>  </span><a name="local-3458764513820541114"><span class="hs-identifier">fromString</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Network.XmlRpc.Types.html#stringValue"><span class="hs-identifier hs-var">stringValue</span></a><span>
</span><a name="line-273"></a><span>
</span><a name="line-274"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-275"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-276"></a><span>
</span><a name="line-277"></a><span class="hs-comment">{-| the type ('ValueType') of the given value ('Value').

For example,

@
&gt; 'valueType' ('ValueBool' _)
'TypeBool'
@

i.e.

@
&gt;&gt;&gt; import Prelude (undefined)
&gt;&gt;&gt; valueType (ValueBool False)
TypeBool
&gt;&gt;&gt; valueType (ValueBool True)
TypeBool
&gt;&gt;&gt; valueType (ValueBool undefined)
TypeBool
@

and so on.

-}</span><span>
</span><a name="line-301"></a><span>
</span><a name="line-302"></a><span class="hs-identifier">valueType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Network.XmlRpc.Types.html#Value"><span class="hs-identifier hs-type">Value</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Network.XmlRpc.Types.html#ValueType"><span class="hs-identifier hs-type">ValueType</span></a><span>
</span><a name="line-303"></a><a name="valueType"><a href="Network.XmlRpc.Types.html#valueType"><span class="hs-identifier">valueType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-304"></a><span>
</span><a name="line-305"></a><span>  </span><a href="Network.XmlRpc.Types.html#ValueBool"><span class="hs-identifier hs-var">ValueBool</span></a><span>      </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Network.XmlRpc.Types.html#TypeBool"><span class="hs-identifier hs-var">TypeBool</span></a><span>
</span><a name="line-306"></a><span>  </span><a href="Network.XmlRpc.Types.html#ValueInt"><span class="hs-identifier hs-var">ValueInt</span></a><span>       </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Network.XmlRpc.Types.html#TypeInt"><span class="hs-identifier hs-var">TypeInt</span></a><span>
</span><a name="line-307"></a><span>  </span><a href="Network.XmlRpc.Types.html#ValueDouble"><span class="hs-identifier hs-var">ValueDouble</span></a><span>    </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Network.XmlRpc.Types.html#TypeDouble"><span class="hs-identifier hs-var">TypeDouble</span></a><span>
</span><a name="line-308"></a><span>  </span><a href="Network.XmlRpc.Types.html#ValueString"><span class="hs-identifier hs-var">ValueString</span></a><span>    </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Network.XmlRpc.Types.html#TypeString"><span class="hs-identifier hs-var">TypeString</span></a><span>
</span><a name="line-309"></a><span>  </span><a href="Network.XmlRpc.Types.html#ValueUnwrapped"><span class="hs-identifier hs-var">ValueUnwrapped</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Network.XmlRpc.Types.html#TypeString"><span class="hs-identifier hs-var">TypeString</span></a><span>
</span><a name="line-310"></a><span>  </span><a href="Network.XmlRpc.Types.html#ValueBase64"><span class="hs-identifier hs-var">ValueBase64</span></a><span>    </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Network.XmlRpc.Types.html#TypeBase64"><span class="hs-identifier hs-var">TypeBase64</span></a><span>
</span><a name="line-311"></a><span>  </span><a href="Network.XmlRpc.Types.html#ValueDateTime"><span class="hs-identifier hs-var">ValueDateTime</span></a><span>  </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Network.XmlRpc.Types.html#TypeDateTime"><span class="hs-identifier hs-var">TypeDateTime</span></a><span>
</span><a name="line-312"></a><span>  </span><a href="Network.XmlRpc.Types.html#ValueStruct"><span class="hs-identifier hs-var">ValueStruct</span></a><span>    </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Network.XmlRpc.Types.html#TypeStruct"><span class="hs-identifier hs-var">TypeStruct</span></a><span>
</span><a name="line-313"></a><span>  </span><a href="Network.XmlRpc.Types.html#ValueArray"><span class="hs-identifier hs-var">ValueArray</span></a><span>     </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Network.XmlRpc.Types.html#TypeArray"><span class="hs-identifier hs-var">TypeArray</span></a><span>
</span><a name="line-314"></a><span>
</span><a name="line-315"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-316"></a><span>
</span><a name="line-317"></a><span class="hs-comment">{-|

**WARNING** this is a partial function, because it performs validation.

-}</span><span>
</span><a name="line-322"></a><span>
</span><a name="line-323"></a><span class="hs-identifier">stringValue</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Network.XmlRpc.Types.html#Value"><span class="hs-identifier hs-type">Value</span></a><span>
</span><a name="line-324"></a><a name="stringValue"><a href="Network.XmlRpc.Types.html#stringValue"><span class="hs-identifier">stringValue</span></a></a><span>
</span><a name="line-325"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Network.XmlRpc.Types.html#validStringValue"><span class="hs-identifier hs-var">validStringValue</span></a><span>
</span><a name="line-326"></a><span>  </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-identifier">_stringValue</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-327"></a><span>
</span><a name="line-328"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-329"></a><span>
</span><a name="line-330"></a><span class="hs-comment">{-|



-}</span><span>
</span><a name="line-335"></a><span>
</span><a name="line-336"></a><span class="hs-identifier">validStringValue</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Network.XmlRpc.Types.html#Value"><span class="hs-identifier hs-type">Value</span></a><span>
</span><a name="line-337"></a><a name="validStringValue"><a href="Network.XmlRpc.Types.html#validStringValue"><span class="hs-identifier">validStringValue</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">_validStringValue</span><span>
</span><a name="line-338"></a><span>
</span><a name="line-339"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-340"></a><span>
</span><a name="line-341"></a><span class="hs-comment">{-| A (successful) method that returns nothing. 

@&#8801; &quot;&quot;@

The empty string substitutes '()', because the XML-RPC Standard doesn't explicitly support the @null@ value.

-}</span><span>
</span><a name="line-348"></a><span>
</span><a name="line-349"></a><span class="hs-identifier">emptyMethodReturn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Network.XmlRpc.Types.html#MethodReturn"><span class="hs-identifier hs-type">MethodReturn</span></a><span>
</span><a name="line-350"></a><a name="emptyMethodReturn"><a href="Network.XmlRpc.Types.html#emptyMethodReturn"><span class="hs-identifier">emptyMethodReturn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Network.XmlRpc.Types.html#MethodReturn"><span class="hs-identifier hs-var">MethodReturn</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span>
</span><a name="line-351"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-352"></a><span>  </span><a name="local-6989586621679135833"><a href="#local-6989586621679135833"><span class="hs-identifier">returnValue</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">coerce</span><span> </span><span class="hs-special">(</span><a href="Network.XmlRpc.Types.html#stringValue"><span class="hs-identifier hs-var">stringValue</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-353"></a><span>
</span><a name="line-354"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-355"></a><span>
</span><a name="line-356"></a><span class="hs-comment">-- | @= 'emptyMethodReturn'@</span><span>
</span><a name="line-357"></a><span class="hs-identifier">defaultMethodReturn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Network.XmlRpc.Types.html#MethodReturn"><span class="hs-identifier hs-type">MethodReturn</span></a><span>
</span><a name="line-358"></a><a name="defaultMethodReturn"><a href="Network.XmlRpc.Types.html#defaultMethodReturn"><span class="hs-identifier">defaultMethodReturn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Network.XmlRpc.Types.html#emptyMethodReturn"><span class="hs-identifier hs-var">emptyMethodReturn</span></a><span>
</span><a name="line-359"></a><span>
</span><a name="line-360"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-361"></a><span>
</span><a name="line-362"></a><span class="hs-comment">{-| A non-zero code and no message:

@
'code'    = 1
'message' = &quot;&quot;
@

-}</span><span>
</span><a name="line-370"></a><span>
</span><a name="line-371"></a><span class="hs-identifier">defaultMethodFault</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Network.XmlRpc.Types.html#MethodFault"><span class="hs-identifier hs-type">MethodFault</span></a><span>
</span><a name="line-372"></a><a name="defaultMethodFault"><a href="Network.XmlRpc.Types.html#defaultMethodFault"><span class="hs-identifier">defaultMethodFault</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Network.XmlRpc.Types.html#MethodFault"><span class="hs-identifier hs-var">MethodFault</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span>
</span><a name="line-373"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-374"></a><span>  </span><a name="local-6989586621679135834"><a href="#local-6989586621679135834"><span class="hs-identifier">code</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-375"></a><span>  </span><a name="local-6989586621679135835"><a href="#local-6989586621679135835"><span class="hs-identifier">message</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-376"></a><span>
</span><a name="line-377"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-378"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-379"></a><span class="hs-comment">{- NOTES





valueType :: Value -&gt; Maybe ValueType
valueType = \case

  ValueBool      {} -&gt; Just TypeBool
  ValueInt       {} -&gt; Just TypeInt
  ValueDouble    {} -&gt; Just TypeDouble
  ValueString    {} -&gt; Just TypeString
  ValueUnwrapped {} -&gt; Just TypeUnwrapped
  ValueBase64    {} -&gt; Just TypeBase64
  ValueDateTime  {} -&gt; Just TypeDateTime
  ValueStruct    {} -&gt; Just TypeStruct
  ValueArray     {} -&gt; Just TypeArray
  _                 -&gt; Nothing






class XmlRpcType a where

data XmlRpcValue a where
 XmlRpc :: XmlRpcType a =&gt; a -&gt; XmlRpcValue a

instance XmlRpcType (XmlRpcValue a) where
 toValue (XmlRpc x) = toValue x
 getType (XmlRpc x) = getType x
 fromValue = ... -- needs constraint, as it **produces**





Instances in general must specify toJSON and should (but don't need to) specify toEncoding.



@~ ExceptT String m a@

data Parser a


instance MonadFail Parser




@~ Either String a@

data Result a



.


type Encoding = Encoding' Value 

-- | An encoding of a JSON value.
--
-- @tag@ represents which kind of JSON the Encoding is encoding to,
-- we reuse 'Text' and 'Value' as tags here.


newtype Encoding' tag = Encoding {
      fromEncoding :: Builder
}



Builder ~ (Text -&gt; Text)




Data.Text.concat is an O(n+m) operation where n and m are the lengths of the strings you want to concat. This is because a new memory buffer of size n + m must be allocated to store the result of the concatenation.

Builder is specifically optimized for the mappend operation. It's a cheap O(1) operation (function composition, which is also excellently optimized by GHC). With Builder you are essentially building up the instructions for how to produce the final string result, but delaying the actual creation until you do some Builder -&gt; Text transformation.

^ https://stackoverflow.com/questions/29102772/haskell-should-i-use-data-text-lazy-builder-to-construct-my-text-values






-- newtype MethodCall = MethodCall

--   String

--   deriving stock    (Show,Read,Lift,Generic)
--   deriving newtype  (Eq,Ord,Semigroup,Monoid)
--   deriving newtype  (NFData,Hashable)

-- instance IsString MethodCall where
--   fromString = coerce






-}</span><span>
</span><a name="line-488"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-489"></a><span class="hs-comment">--------------------------------------------------</span></pre></body></html>